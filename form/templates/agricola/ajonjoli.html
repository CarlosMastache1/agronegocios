{% extends 'base3.html' %}
{% load static %}
{% block content %}

<!-- Iconos de Font Awesome -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />

<!-- Librer√≠a Chart.js para gr√°ficas -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<!-- Plugin para mostrar etiquetas en gr√°ficas -->
<script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels"></script>

<!-- Estilos personalizados -->
<link rel="stylesheet" href="{% static 'css/estilo_estadisticas.css' %}">
<link rel="stylesheet" href="{% static 'css/estilo_estadisticas2.css' %}">
<link rel="stylesheet" href="{% static 'estilos/carrusel_style.css' %}">

<!-- ==============================
  Banner principal (slider de im√°genes)
============================== -->
<main id="contents" class="site-contnts">

	<div class="carousel-comp" id="carousel-comp">
		<div class="carousel-comp__slides" id="slides-comp">
			<div class="carousel-comp__slide">
				<img src="{% static 'agricola/ajonjoli/imagenes/1.png' %}" alt="Imagen 1" />
			</div>
			<div class="carousel-comp__slide">
				<img src="{% static 'agricola/ajonjoli/imagenes/2.png' %}" alt="Imagen 2" />
			</div>
		</div>

		<div class="carousel-comp__indicators" id="indicators-comp">
			<!-- Cubos blancos generados por JS -->
		</div>
	</div>

	<script src="{% static 'js/carrusel-control.js' %}"></script>
</main>

<!-- Cinta ticker -->
<div class="ticker">
	<div class="ticker-content" id="ticker-content">
		Cargando datos...
	</div>
</div>

<div>
	<div id="body_pag">
		<!-- ==============================
    	  Secci√≥n 1 - Descripci√≥n del cultivo
    	 ============================== -->
		<section id="section1" class="section">
			<h1>DESCRIPCI√ìN DEL <strong>AJONJOL√ç</strong></h1>
			<p style="text-align: center; font-size: 1.8rem; margin-bottom: 30px;" id="descripcion">
				<!-- Texto informativo con datos din√°micos que ser√°n insertados con JavaScript -->
				Este cultivo es anual por lo que su ciclo de vida es de <strong>3 a 4 meses</strong>, Oaxaca tiene
				<strong></strong> productores de ajonjol√≠, se encuentra en el <strong></strong> en
				producci√≥n a nivel nacional, con <strong></strong> productores de este cultivo.
			</p>

			<!-- Tarjetas informativas, cada una enlaza a otra secci√≥n -->
			<div class="descripcion">
				<div class="container">
					<div class="card" data-target="section1">
						<h2><i class="fa-solid fa-leaf" style="color: green;"></i> Cultivo Perenne</h2>
						<p>
							Ciclo de vida de <strong>3 a 4 meses</strong> seg√∫n condiciones clim√°ticas y manejo
							agr√≠cola.
						</p>
					</div>

					<div class="card" data-target="section2">
						<h2>üìä Lugar a nivel mundial</h2>
						<p id="des_mundo">
							M√©xico ocupa el <strong></strong> a nivel mundial en la producci√≥n de ajonjol√≠, con
							una superficie de producci√≥n de <strong></strong>.
						</p>
					</div>

					<div class="card" data-target="section8">
						<h2>üìç Municipios en Oaxaca</h2>
						<p id="des_muni">
							En Oaxaca hay <strong></strong> que est√°n dedicados al cultivo de ajonjol√≠.
						</p>
					</div>

					<div class="card" data-target="section3">
						<h2>üá≤üáΩ Lugar a nivel nacional</h2>
						<p id="des_na">Oaxaca ocupa el <strong></strong> nacional en producci√≥n de ajonjol√≠, con
							un volumen
							de producci√≥n de <strong></strong>, una superficie de producci√≥n de <strong></strong>, con
							un rendimiento de <strong></strong>, y un valor de
							producci√≥n <strong></strong>.
						</p>
					</div>

					<div class="card" data-target="section6">
						<h2>üìà Regi√≥n con mayor producci√≥n</h2>
						<p id="des_reg">
							La regi√≥n del <strong></strong> es la region con mayor
							producci√≥n de ajonjol√≠ en el estado de Oaxaca, contando con <strong></strong>,
							un volumen de producci√≥n de <strong></strong>, una superficie de <strong></strong>, con un
							rendimiento de <strong></strong>, y un valor de
							producci√≥n de <strong></strong>.
						</p>
					</div>

					<div class="card" data-target="section6">
						<h2>üßëüèΩ‚Äçüåæ Pueblos ind√≠genas</h2>
						<p id="des_pue">Un total de <strong></strong> se encuentran dentro de la
							producci√≥n de
							ajonjol√≠.</p>
					</div>
				</div>
			</div>
		</section>

		<!-- ==============================
    	  Secci√≥n 2 - Producci√≥n Mundial 
    	============================== -->
		<section id="section2" class="section">
			<h1>PRODUCCI√ìN MUNDIAL DE AJONJOL√ç</h1>
			<H2>Cierre Agr√≠cola 2022</H2>

			<!-- Controles de paginaci√≥n y b√∫squeda -->
			<div class="contenedor_col1">
				<div class="columna1">
					<div class="controls">
						<label>
							Mostrar
							<select id="rowsPerPage">
								<option value="10">10</option>
								<option value="25">25</option>
								<option value="50">50</option>
								<option value="100">100</option>
							</select>
							registros
						</label>

						<input type="text" id="searchInput" placeholder="Buscar...">
					</div>

					<!-- Tabla que se llenar√° din√°micamente -->
					<div class="tabla-scroll">
						<table id="dataTable" class="tabla-datos">
							<thead>
								<tr>
									<th>RANKING</th>
									<th>PA√çS</th>
									<th>SUPERFICIE COSECHADA (HA)</th>
								</tr>
							</thead>
							<tbody>
								<!-- Filas din√°micas -->
							</tbody>
							<tfoot>
								<tr id="total_datos_tab1">

								</tr>
							</tfoot>
						</table>
					</div>

					<!-- Navegaci√≥n de p√°ginas -->
					<div class="pagination">
						<button id="prevBtn">Anterior</button>
						<span id="pageInfo"></span>
						<button id="nextBtn">Siguiente</button>
					</div>
				</div>

				<!-- Mapa mundial en un iframe -->
				<iframe id="frame_mundo_prod" src="{% url 'iframeMundo' %}" class="columna2" frameborder="0"></iframe>
			</div>
			<p class="fuentes_pie fuente_mapa"><strong>FUENTE: ELABORACI√ìN PROPIA CON DATOS DE ORGANIZACI√ìN DE LAS
					NACIONES UNIDAS PARA LA
					ALIMENTACI√ìN Y LA AGRICULTURA (FAO), A√ëO (2022)</strong>
				<button onclick="recargarMundo()" class="boton-recargar"><i class="fa-solid fa-rotate"></i></button>
			</p>
		</section>

		<!-- ==============================
    	  Secci√≥n 3 - Producci√≥n Nacional
    	============================== -->
		<section id="section3" class="section">
			<h1>PRODUCCI√ìN NACIONAL DE AJONJOL√ç</h1>
			<H2>Cierre Agr√≠cola 2022</H2>

			<div class="controls">
				<label>
					Mostrar
					<select id="rowsPerPage2">
						<option value="10">10</option>
						<option value="25">25</option>
						<option value="50">50</option>
						<option value="100">100</option>
					</select>
					registros
				</label>

				<input type="text" id="searchInput2" placeholder="Buscar...">
			</div>
			<div class="tabla-scroll">
				<table id="data2Table" class="tabla-datos">
					<thead>
						<tr>
							<th>RANKING</th>
							<th>ENTIDAD FEDERATIVA</th>
							<th>VOLUMEN DE PRODUCCI√ìN (TON)</th>
							<th>SUPERFICIE SEMBRADA (HA)</th>
							<th>RENDIMIENTO (TON/HA)</th>
							<th>VALOR DE LA PRODUCCI√ìN ($)</th>
						</tr>
					</thead>
					<tbody>
						<!-- Filas din√°micas -->
					</tbody>
					<tfoot>
						<tr id="total_datos_tab2"></tr>
					</tfoot>
				</table>
			</div>

			<div class="pagination">
				<button id="prevBtn2">Anterior</button>
				<span id="pageInfo2"></span>
				<button id="nextBtn2">Siguiente</button>
			</div>
			<p class="fuentes_pie"><strong>FUENTE: ELABORACI√ìN PROPIA CON DATOS DE SIAP, CIERRE AGR√çCOLA 2023</strong>
			</p>
			<iframe id="iframe_mexico_prod" src="{% url 'iframeMexico' %}" class="mapa_mexico_sty" frameborder="0">
			</iframe>
			<p class="fuentes_pie fuente_mapa">
				<strong>FUENTE: ELABORACI√ìN PROPIA CON DATOS DE SIAP, CIERRE AGR√çCOLA 2023</strong>
				<button onclick="recargarMexico()" class="boton-recargar"><i class="fa-solid fa-rotate"></i></button>
			</p>
		</section>

		<!-- ==============================
    	  Secci√≥n 4 - Balanza Comercial
    	============================== -->
		<section id="section4" class="section">
			<h1>BALANZA COMERCIAL DE AJONJOL√ç EN M√âXICO</h1>

			<div class="chart-container">
				<canvas id="lineChart"></canvas>
			</div>
			<p class="fuentes_pie"><strong>FUENTE: ELABORACI√ìN PROPIA CON DATOS DE ORGANIZACI√ìN DE LAS NACIONES UNIDAS
					PARA LA
					ALIMENTACI√ìN Y LA AGRICULTURA (FAO), A√ëO (2022)</strong></p>
		</section>


		<!-- ==============================
    	  Secci√≥n 5 - Producci√≥n Hist√≥rica
    	============================== -->
		<section id="section5" class="section">
			<h1>PRODUCCI√ìN HIST√ìRICA DE AJONJOL√ç EN OAXACA</h1>
			<div class="chart-container">
				<canvas id="lineChart2"></canvas>
			</div>
			<p class="fuentes_pie"><strong>FUENTE: ELABORACI√ìN PROPIA CON DATOS DE SIAP</strong></p>
		</section>


		<!-- ==============================
    	  Secci√≥n 6 - Producci√≥n del Producto
    	============================== -->
		<section id="section6" class="section">
			<h1>PRODUCCI√ìN DE AJONJOL√ç EN OAXACA</h1>
			<div class="tabla-scroll">
				<table class="tabla-datos">
					<thead>
						<tr>
							<th>REGION</th>
							<th>VOLUMEN DE PRODUCCI√ìN (TON)</th>
							<th>SUPERFICIE SEMBRADA (HA)</th>
							<th>RENDIMIENTO (TON/HA)</th>
							<th>VALOR DE LA PRODUCCI√ìN ($)</th>
							<th>CANTIDAD DE MUNICIPIOS</th>
						</tr>
					</thead>

					<tbody id="tabla_produccion_prod_oax">

					</tbody>
					<tfoot>
						<tr id="total_tab_pro_miel_oax">
						</tr>
					</tfoot>
				</table>
			</div>
			<p class="fuentes_pie fuente_elemento"><strong>FUENTE: ELABORACI√ìN PROPIA CON DATOS DE SIAP, CIERRE AGR√çCOLA
					2023</strong>
			</p>

			<h4>VOLUMEN DE PRODUCCI√ìN POR PUEBLO IND√çGENA
			</h4>

			<div class="chart-container">
				<canvas id="lineChart3"></canvas>
			</div>
			<p class="fuentes_pie"><strong>FUENTE: ELABORACI√ìN PROPIA CON DATOS DE SIAP, CIERRE AGR√çCOLA 2023</strong>
			</p>
		</section>


		<!-- ==============================
    	  Secci√≥n 7 - Estacionalidad del producto
    	============================== -->
		<section id="section7" class="section">
			<h1>ESTACIONALIDAD DE LA PRODUCCI√ìN EN OAXACA</h1>
			<p style="text-align: center; font-size: 1.8rem; margin-bottom: 30px;" id="estacionalidad">
				La estacionalidad de la producci√≥n hace referencia a la frecuencia de meses donde se produce ajonjol√≠ en
				el estado
				de Oaxaca, medido a trav√©s del √≠ndice de volumen f√≠sico, es decir, el mes de <strong>noviembre</strong>
				es
				cuando se
				cosecha m√°s ajonjol√≠ alcanzando <strong>1,151 puntos</strong> de dicho √≠ndice.
			</p>
			<h2>INDICE DE VOLUMEN F√çSICO (IVF)</h2>
			<div class="chart-container">
				<canvas id="lineChart4"></canvas>
			</div>
			<p class="fuentes_pie"><strong>FUENTE: ELABORACI√ìN PROPIA CON DATOS DE SIAP, CIERRE AGR√çCOLA 2023</strong>
			</p>
		</section>

		<!-- ==============================
    	  Secci√≥n 8 - Municipios de Producci√≥n
    	============================== -->
		<section id="section8" class="section">
			<h1>MUNICIPIOS QUE PRODUCEN DE AJONJOL√ç EN OAXACA</h1>
			<iframe loading="lazy" id="frame_oaxaca" src="{% url 'iframeOaxaca' %}" class="mapa_mexico_sty"
				frameborder="0"></iframe>
			<p class="fuentes_pie fuente_mapa"><strong>FUENTE: ELABORACI√ìN PROPIA CON DATOS DE SIAP, CIERRE AGR√çCOLA
					2023</strong>
				<button onclick="recargarOaxaca()" class="boton-recargar"><i class="fa-solid fa-rotate"></i></button>
			</p>
			<div id="botones"></div>
			<div id="titulo_regmun"></div>
			<div id="tabla"></div>
		</section>
	</div>

	<!-- ==============================
  	  Barra lateral de progreso/navegaci√≥n r√°pida
  	============================== -->
	<div class="progress-bar">
		<!-- Cada c√≠rculo representa un enlace r√°pido a una secci√≥n -->
		<div class="progress-circle" data-target="section1"><i class="fa-solid fa-book"></i></div>
		<div class="progress-circle" data-target="section2"><i class="fa-solid fa-earth-americas"></i></div>
		<div class="progress-circle" data-target="section3"><i class="fa-solid fa-map-location-dot"></i></div>
		<div class="progress-circle" data-target="section4"><i class="fa-solid fa-scale-balanced"></i></div>
		<div class="progress-circle" data-target="section5"><i class="fa-solid fa-chart-line "></i></div>
		<div class="progress-circle" data-target="section6"><i class="fa-solid fa-chart-pie"></i></div>
		<div class="progress-circle" data-target="section7"><i class="fa-solid fa-calendar-days"></i></div>
		<div class="progress-circle" data-target="section8"><i class="fa-solid fa-map-pin"></i></div>
	</div>
</div>

<!-- ==============================
  Script para navegaci√≥n y seguimiento de secci√≥n activa
==============================-->
<script>
	// Obtiene todos los elementos necesarios
	const circles = document.querySelectorAll('.progress-circle');
	const sections = document.querySelectorAll('section');
	const cards = document.querySelectorAll('.card');

	// Clic en un c√≠rculo -> scroll suave a la secci√≥n
	circles.forEach(circle => {
		circle.addEventListener('click', () => {
			const targetId = circle.getAttribute('data-target');
			const targetSection = document.getElementById(targetId);
			targetSection.scrollIntoView({ behavior: 'smooth' });
		});
	});

	// Clic en un c√≠rculo -> scroll suave a la secci√≥n
	cards.forEach(card => {
		card.addEventListener('click', () => {
			const targetId = card.getAttribute('data-target');
			const targetSection = document.getElementById(targetId);
			targetSection.scrollIntoView({ behavior: 'smooth' });
		});
	});

	// Detectar qu√© secci√≥n est√° en vista y activar el c√≠rculo correspondiente
	window.addEventListener('scroll', () => {
		let current = '';
		sections.forEach(section => {
			const sectionTop = section.offsetTop;
			const sectionHeight = section.clientHeight;
			if (pageYOffset >= sectionTop - sectionHeight / 3) {
				current = section.getAttribute('id');
			}
		});

		// Scroll a la secci√≥n al hacer clic
		circles.forEach(circle => {
			circle.classList.remove('active');
			if (circle.getAttribute('data-target') === current) {
				circle.classList.add('active');
			}
		});
	});
</script>

<script src="{% static 'data/mapas/agricola/ajonjoli.js' %}"></script>
<script src="{% static 'agricola/ajonjoli/js/ajonjoli.js' %}"></script>

<script>
	// ==============================
	// Comunicaci√≥n con iframes (mapas y tablas)
	// ==============================

	// Env√≠a datos a los iframes cuando se cargan
	const mundo_producto = document.getElementById("frame_mundo_prod");
	mundo_producto.onload = function () {
		mundo_producto.contentWindow.postMessage(paises_datos_pro, "*");
	}

	const mexico_producto = document.getElementById("iframe_mexico_prod");
	mexico_producto.onload = function () {
		mexico_producto.contentWindow.postMessage(tab_pro_nacional, "*");
	}

	const iframe = document.getElementById('frame_oaxaca');
	iframe.onload = function () {
		iframe.contentWindow.postMessage(regionesConMunicipios, "*");
	};

	function recargarMexico() {
		const iframe = document.getElementById('iframe_mexico_prod');
		iframe.src = iframe.src; // Recarga el iframe actual
	}

	function recargarMundo() {
		const iframe = document.getElementById('frame_mundo_prod');
		iframe.src = iframe.src; // Recarga el iframe actual
	}

	function recargarOaxaca() {
		const iframe = document.getElementById('frame_oaxaca');
		iframe.src = iframe.src; // Recarga el iframe actual
	}
</script>

<script>
	// Funci√≥n para obtener y actualizar los datos en la cinta
	function fetchTickerData() {
		fetch('/grafica-maiz/api/')
			.then(response => response.json())
			.then(data => {
				let tickerText = `Precio Actual: ${data.current_price} | Apertura: ${data.open_price} | M√°ximo: ${data.high_price} | M√≠nimo: ${data.low_price}`;
				document.getElementById('ticker-content').innerText = tickerText;
			})
			.catch(error => console.error("Error al obtener datos:", error));
	}

	// Obtiene los datos inicialmente y actualiza cada 10 segundos
	fetchTickerData();
	setInterval(fetchTickerData, 10000);
</script>

{% endblock %}